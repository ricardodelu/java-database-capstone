<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="/">
    <title>Clinic Management System</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/assets/images/logo/logo.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/index.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    
    <!-- JS links for utility with defer -->
    <script src="/js/util.js" defer></script>
    <script src="/js/render.js" defer></script>
    
    <!-- JS links for components -->
    <script src="/js/components/header.js" defer></script>
    <script src="/js/components/footer.js" defer></script>
</head>
<body>
    <div class="container">
        <div class="wrapper">
            <!-- Header -->
            <div id="header"></div>

            <!-- Main Content -->
            <main class="main-content">
                <h2>Select Your Role</h2>
                <div class="role-buttons">
                    <button id="adminBtn" class="role-btn" onclick="selectRole('admin')">
                        <i class="fas fa-user-shield"></i>
                        <span>Administrator</span>
                    </button>
                    <button id="doctorBtn" class="role-btn" onclick="selectRole('doctor')">
                        <i class="fas fa-user-md"></i>
                        <span>Doctor</span>
                    </button>
                    <button id="patientBtn" class="role-btn" onclick="selectRole('patient')">
                        <i class="fas fa-user"></i>
                        <span>Patient</span>
                    </button>
                </div>
            </main>

            <!-- Footer -->
            <div id="footer"></div>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span id="closeModal" class="close">&times;</span>
            <div id="modal-body">
                <!-- Dynamic content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Global functions -->
    <script>
        // Global functions
        function selectRole(role) {
            role = role.trim().toLowerCase();
            if (role.endsWith('btn')) {
                role = role.replace('btn', '');
            }
            if (role === 'administrator') role = 'admin';
            if (role === 'physician') role = 'doctor';
            if (role === 'user') role = 'patient';
            console.log('Role selected:', role);
            
            // Store the selected role in localStorage as per requirements
            localStorage.setItem('selectedRole', role);
            
            // Navigate to login page with role parameter
            window.location.href = `/login.html?role=${role}`;
        }
        
        // Initialize role buttons and load header/footer
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // Load header and footer
                const { Header } = await import('/js/components/header.js');
                const { Footer } = await import('/js/components/footer.js');
                const header = new Header();
                const footer = new Footer();
                await header.mount('header', 'Clinic Management System', false);
                await footer.mount('footer');
                
                // Initialize role buttons
                const roleButtons = document.querySelectorAll('.role-btn');
                roleButtons.forEach(button => {
                    button.addEventListener('click', function(e) {
                        let role = button.id.replace('Btn', '').toLowerCase();
                        selectRole(role);
                    });
                });
                
                console.log('Global scripts initialized');
            } catch (error) {
                console.error('Error initializing page:', error);
            }
        });
    </script>
    
    <!-- Service for role selection and modal behavior -->
    <script type="module" src="/js/services/index.js" defer></script>
</body>
</html>